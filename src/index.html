<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="stylesheet" href="styles/main.css">
    <title>City Builder with three js and live server</title>
</head>
<body>
<div id="root-window" class="root-window">
  <!-- Part 5 (Raycasting) -->
    <div id="game-window" class="game-window">
      <div id="toolbar" class="toolbar">
        <button type="button" id="bulldoze-btn" class="toolbar-btn selected" onclick="setActiveTool(event,'bulldoze')">Détruire</button>
        <button type="button" id="residential-btn" class="toolbar-btn" onclick="openModal(event,'residential')">Panel</button>
        <button type="button" id="roads-btn" class="toolbar-btn" onclick="setActiveTool(event,'roads')">Routes</button> 
      
      </div>

      <div id="select-object" class="select-object">
            {{/* <button type="button" id="person-btn" class="toolbar-btn" onclick="setActiveTool(event,'House-Blue')">Résidence Bleu</button>
            <button type="button" id="person-btn" class="toolbar-btn" onclick="setActiveTool(event,'House-Red')">Résidence Rouge</button> */}}
      </div>
      
    </div>
</div>
<script type="module" src="./game.js"></script>
<script type="module">
    import { createGame } from './game.js';
    import { buildingModels, miscellaneous, assetNames, buildingModelsObj, dragonModelObj } from './buildings.js';
    let selectedControl = document.getElementById('bulldoze-btn');
  
    window.onload = () => {
       window.game = createGame();
    } 

    const buttonData = [
        { text: "Maison bleu", tool: "House-Blue" },
        { text: "Maison rouge", tool: "House-Red" },
        { text: "Maison violette", tool: "House-Purple" },
        { text: "Tombstone", tool: "Tombstone-1"},
        { text: "Dragon", tool: "Dragon"}
    ];


    window.openModal = (event, toolId) => {
       console.log('we click')
       let objectsPanel = document.querySelector('.select-object');
       objectsPanel.classList.toggle('active');
       window.game.setActiveToolId('residential');
       console.log('------>>>> ', buildingModelsObj)
       console.log('------>>>> ', dragonModelObj)
       createButtons(buttonData,  objectsPanel);

    }

function createButtons(data, modalLayout) {
    modalLayout.innerHTML = '';
    buttonData.forEach(buttonInfo => {
        const button = document.createElement('button');
        button.type = 'button';
        button.id = buttonInfo.id;
        button.classList.add('toolbar-btn');
        button.textContent = buttonInfo.text;
        button.addEventListener('click', () => {
            setActiveTool(event, buttonInfo.tool);
            // Or call openModal if needed
            // openModal(event, buttonInfo.tool);
        });
        modalLayout.appendChild(button);
    });
}

    window.setActiveTool = (event, toolId) => {
      if(selectedControl){
        selectedControl.classList.remove('selected');
      }
      selectedControl = event.target;
      selectedControl.classList.add('selected');
      window.game.setActiveToolId(toolId);      
    }

</script>

</body>
</html>